<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Arnoldi Publicidade" />
  <meta name="description" content="Roteiros e pacotes de viagem exclusivos para atender o público brasileiro!">
  <link rel="icon" type="image/png" href="https://newage.tur.br/view/imagens/favicon.ico">
  <title>New Age — Busca Rápida de Produtos</title>

  <!-- Mantemos os mesmos estilos públicos do site para replicar o design -->
  <link href="https://newage.tur.br/view/css/plugins.css" rel="stylesheet">
  <link href="https://newage.tur.br/view/css/style.css" rel="stylesheet">
  <link href="https://newage.tur.br/view/css/custom.css" rel="stylesheet">

  <!-- CSS embutido mínimo (estilos de produto e pequenos ajustes) -->
  <style>
    /* Ajustes mínimos para os cards de produto */
    .product-link {
      display:block;
      background:#ffffff;
      padding:14px 16px;
      border-radius:8px;
      margin-bottom:12px;
      color:#1b1b1b;
      text-decoration:none;
      border:1px solid #e6e6e6;
      transition: all .15s ease;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
      font-weight:600;
    }
    .product-link:hover {
      background:#ffd200;
      color:#000;
      transform: translateY(-2px);
      text-decoration:none;
    }

    /* Container de busca */
    .busca-container { padding: 40px 0; }
    .busca-filtros .form-control { height: calc(2.25rem + 10px); }
    .titulo-busca { margin-bottom: 20px; font-size: 1.5rem; font-weight:700; }

    /* responsividade */
    @media (max-width: 576px) {
      .product-link { padding:12px; font-size:14px; }
    }
  </style>
</head>
<body>
<div class="body-inner">

  <!-- ----------------------
       Header (replicado)
       ---------------------- -->
  <header id="header" data-fullwidth="true">
    <div class="header-inner">
      <div class="container">
        <!--Logo-->
        <div id="logo">
          <a href="https://newage.tur.br">
            <span class="logo-default">
              <img src="https://newage.tur.br/view/imagens/logo-new-age.png" style="width:179px;" alt="New Age">
            </span>
            <span class="logo-dark">New Age</span>
          </a>
        </div>
        <!--Navigation Resposnive Trigger-->
        <div id="mainMenu-trigger"> <a class="lines-button x"> <span class="lines"></span> </a> </div>
        <!--Navigation-->
        <div id="mainMenu">
          <div class="container">
            <nav>
              <ul class="menu">
                <li><a href="https://newage.tur.br/quem-somos">Quem Somos</a></li>
                <li class="dropdown"><a href="#">Destinos</a>
                  <ul class="dropdown-menu">
                    <li class="dropdown-submenu"><a href="#">Brasil</a>
                      <ul class="dropdown-menu">
                        <li><a href="https://newage.tur.br/destino/centro-oeste/">Centro-Oeste</a></li>
                        <li><a href="https://newage.tur.br/destino/norte/">Norte</a></li>
                        <li><a href="https://newage.tur.br/destino/nordeste/">Nordeste</a></li>
                        <li><a href="https://newage.tur.br/destino/sul/">Sul</a></li>
                        <li><a href="https://newage.tur.br/destino/sudeste/">Sudeste</a></li>
                      </ul>
                    </li>
                    <!-- (demais submenus omitidos para brevidade; o visual será mantido pelos CSS do site) -->
                  </ul>
                </li>

                <li><a href="https://newage.tur.br/fale-conosco">Fale Conosco</a></li>
                <li><a href="https://fastbooking.newage.tur.br/" target="_blank" class="menu-reserve">FAST BOOKING</a></li>
                <li><a class="menu-telefone" href="tel:1143957078"><i class="fa fa-phone fa-flip-horizontal" aria-hidden="true"></i> (11) 4395-7078</a></li>
              </ul>
            </nav>
          </div>
        </div>
        <!--end: Navigation-->
      </div>
    </div>
  </header>
  <!-- end: Header -->

  <!-- ======= MAIN: aqui entra o container principal com a busca/listagem ======= -->
  <main role="main">
    <div class="container busca-container">

      <!-- Título da seção -->
      <div class="row">
        <div class="col-12">
          <h1 class="titulo-busca">Busca Rápida de Produtos</h1>
          <p class="text-muted">Filtre por tipo, selo e cidade. Clique no produto para abrir o link.</p>
        </div>
      </div>

      <!-- FILTROS -->
      <div class="row busca-filtros mb-4">
        <div class="col-md-3 col-12 mb-2">
          <label class="form-label"><strong>Tipo</strong></label><br>
          <label class="me-2"><input type="radio" name="tipo" value="Nacional" checked> Nacional</label>
          <label class="me-2"><input type="radio" name="tipo" value="Internacional"> Internacional</label>
        </div>

        <div class="col-md-3 col-6 mb-2">
          <label class="form-label"><strong>Selo</strong></label>
          <select id="seloFilter" class="form-control">
            <option value="">Todos</option>
          </select>
        </div>

        <div class="col-md-3 col-6 mb-2">
          <label class="form-label"><strong>Cidade</strong></label>
          <select id="cidadeFilter" class="form-control">
            <option value="">Todas</option>
          </select>
        </div>
      </div>

      <!-- RESULTADOS -->
      <div id="productList" class="row"></div>

    </div><!-- /.container -->
  </main>

  <!-- ----------------------
       Footer (replicado)
       ---------------------- -->
  <footer id="footer">
    <div class="footer-content" style="padding-top: 40px !important;">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="widget mb-0">
              <div class="widget-title">Contato</div>
              <p class="mb-5"> (11) 4395-7078</p>
              <p class="mb-5"> comercial@newage.tur.br</p>
              <p class="mb-5"> Horário de Funcionamento<br> Segunda a Sexta das 9h00 às 18h30</p>
            </div>
          </div>
          <div class="col-lg-8">
            <div class="row">
              <div class="col-lg-7">
                <div class="widget">
                  <div class="widget-title">Formulários</div>
                  <ul class="list">
                    <li><a href="https://newage.tur.br/news">News</a></li>
                    <li><a href="https://newage.tur.br/formularios">Para reservar</a></li>
                    <li><a href="https://newage.tur.br/pagina/condicoes-gerais/">Condições Gerais</a></li>
                    <li><a href="https://newage.tur.br/formularios">Política de Privacidade</a></li>
                    <li><a href="https://newage.tur.br/formularios">Termo de responsabilidade</a></li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-5">
                <div class="widget">
                  <ul class="list">
                    <li>Redes Sociais:
                      <a href="https://www.instagram.com/newagetur/" target="_blank">Instagram</a>
                      <a href="https://www.facebook.com/NewAgeTurismo/?locale=pt_BR" target="_blank">Facebook</a>
                    </li>
                    <li class="logo-footer"><img src="https://newage.tur.br/view/imagens/logo-new-age-branco.jpg" style="max-width:160px"></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- /.container -->
    </div>

    <div class="copyright-content">
      <div class="container">
        <div class="copyright-text text-center">Copyright 2023 &copy; NEWAGE Viagens e Turismo LTDA - CNPJ 57.949.422/0001-25 - Desenvolvido por <a href="https://www.arnoldi.com.br/?utm_source=newage" target="_blank" style="color: #9ebfdd !important;">Arnoldi Marketing Digital</a></div>
      </div>
    </div>
  </footer>
  <!-- end: Footer -->

</div>
<!-- end: Body Inner -->

<!-- Scroll top (mantido) -->
<a id="scrollTop"><i class="icon-chevron-up"></i><i class="icon-chevron-up"></i></a>

<!-- SCRIPTS QUE O SITE USA (carregamos depois para manter comportamento visual) -->
<script src="https://newage.tur.br/view/js/jquery.js"></script>
<script src="https://newage.tur.br/view/js/plugins.js"></script>
<script src="https://newage.tur.br/view/js/functions.js"></script>

<!-- =========================
     SCRIPT DE LEITURA E EXIBIÇÃO DO CSV
     ========================= -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // URL do CSV — ajuste se o arquivo tiver nome diferente
  const CSV_URL = './base_produtos.csv';

  let rows = []; // array de objetos

  // util: limpar valores (BOM, aspas, espaços)
  function clean(v){
    return (v||'').replace(/\uFEFF/g,'').replace(/^"+|"+$/g,'').trim();
  }

  // detecta separador com base na primeira linha
  function detectSeparator(text){
    const firstLine = text.split(/\r?\n/)[0] || '';
    if(firstLine.indexOf(';') !== -1) return ';';
    if(firstLine.indexOf(',') !== -1) return ',';
    if(firstLine.indexOf('\t') !== -1) return '\t';
    return ','; // fallback
  }

  fetch(CSV_URL, {cache: "no-store"})
    .then(r => {
      if(!r.ok) throw new Error('Falha ao obter CSV: ' + r.status);
      return r.text();
    })
    .then(text => {
      // separador flexível
      const sep = detectSeparator(text);
      const lines = text.split(/\r?\n/).filter(l => l.trim() !== '');
      if(lines.length === 0) throw new Error('CSV vazio');

      const headers = lines.shift().split(sep).map(h => clean(h.toUpperCase()));

      rows = lines.map(line => {
        // Tratamento para campos entre aspas que contenham separador:
        // tentamos dividir por regexp simples que respeita aspas
        let values = [];
        if(sep === ','){
          // regex para CSV comum entre aspas (simples)
          values = line.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g) || line.split(sep);
        } else {
          // para ';' ou '\t' usamos split direto (planilha geralmente exporta assim)
          values = line.split(sep);
        }

        const obj = {};
        headers.forEach((h, i) => obj[h] = clean(values[i] || ''));
        // garantia de campos minimos esperados (nomes: PAIS, REGIAO, SELO, CIDADE, PRODUTO, LINK)
        obj.PAIS = obj.PAIS || '';
        obj.SELO = obj.SELO || '';
        obj.CIDADE = obj.CIDADE || '';
        obj.PRODUTO = obj.PRODUTO || '';
        obj.LINK = obj.LINK || '#';
        obj.tipo = (obj.PAIS.toUpperCase().indexOf('BRASIL') !== -1) ? 'Nacional' : 'Internacional';
        return obj;
      });

      initFiltersAndRender();
    })
    .catch(err => {
      console.error('Erro ao carregar CSV:', err);
      const out = document.getElementById('productList');
      out.innerHTML = '<div class="col-12"><div class="alert alert-danger">Não foi possível carregar a lista de produtos. Verifique se <code>base_produtos.csv</code> está acessível na raiz.</div></div>';
    });

  // popula selos e cidades (cidades dependem do tipo atual)
  function initFiltersAndRender(){
    populateSelo();
    populateCidade(); // inicial com 'Nacional' por default
    // bind de eventos
    document.querySelectorAll('input[name="tipo"]').forEach(r => r.addEventListener('change', () => {
      populateCidade();
      render();
    }));
    document.getElementById('seloFilter').addEventListener('change', render);
    document.getElementById('cidadeFilter').addEventListener('change', render);

    // render inicial
    render();
  }

  function populateSelo(){
    const sel = document.getElementById('seloFilter');
    sel.innerHTML = '<option value="">Todos</option>';
    const uniqueSelos = [...new Set(rows.map(r => r.SELO).filter(Boolean))].sort();
    uniqueSelos.forEach(s => sel.appendChild(new Option(s, s)));
  }

  function populateCidade(){
    const tipo = document.querySelector('input[name="tipo"]:checked').value;
    const selectCidade = document.getElementById('cidadeFilter');
    selectCidade.innerHTML = '<option value="">Todas</option>';

    // Filtrar cidades pelo tipo selecionado:
    // se tipo === 'Nacional', usa apenas registros com PAIS contendo 'BRASIL'
    const cidades = [...new Set(rows
      .filter(r => {
        if(tipo === 'Nacional') return r.PAIS.toUpperCase().indexOf('BRASIL') !== -1;
        return r.PAIS.toUpperCase().indexOf('BRASIL') === -1;
      })
      .map(r => r.CIDADE)
      .filter(Boolean)
    )].sort();

    cidades.forEach(c => selectCidade.appendChild(new Option(c, c)));
  }

  function render(){
    const tipo = document.querySelector('input[name="tipo"]:checked').value;
    const selo = document.getElementById('seloFilter').value;
    const cidade = document.getElementById('cidadeFilter').value;
    const out = document.getElementById('productList');
    out.innerHTML = '';

    // aplica filtros
    const filtered = rows.filter(r => {
      if(r.tipo !== tipo) return false;
      if(selo && r.SELO !== selo) return false;
      if(cidade && r.CIDADE !== cidade) return false;
      return true;
    });

    if(filtered.length === 0){
      out.innerHTML = '<div class="col-12"><p class="text-muted">Nenhum produto encontrado para os filtros selecionados.</p></div>';
      return;
    }

    filtered.forEach(r => {
      const col = document.createElement('div');
      col.className = 'col-md-4 col-sm-6';
      // escapando o link via encodeURI - não alteramos se já for url válida
      const safeHref = (r.LINK && r.LINK !== '#') ? r.LINK : '#';
      col.innerHTML = `
        <a class="product-link" href="${safeHref}" target="_blank" rel="noopener noreferrer">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
            <div>
              <div style="font-size:0.95rem;color:#666;margin-bottom:6px">${r.SELO ? r.SELO + ' • ' : ''}${r.CIDADE ? r.CIDADE : ''}</div>
              <div style="font-size:1rem">${r.PRODUTO}</div>
            </div>
            <div style="font-size:0.9rem;color:#888">›</div>
          </div>
        </a>`;
      out.appendChild(col);
    });
  }

});
</script>

</body>
</html>


<!-- end: BUSCA PRODUTO -->
  

</body>

</html>
